# domi.txt
ğŸ’¾ Î ÏÎ¿Ï„ÎµÎ¹Î½ÏŒÎ¼ÎµÎ½Î· Î´Î¿Î¼Î® Ï†Î±ÎºÎ­Î»Ï‰Î½
ckeapp/
â”œâ”€â”€ run.py
â”œâ”€â”€ .env
â”œâ”€â”€ .flaskenv
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ instance/
â”‚   â””â”€â”€ uploads/
â””â”€â”€ app/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ config.py
    â”œâ”€â”€ extensions.py
    â”œâ”€â”€ models/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ article.py
    â”‚   â””â”€â”€ user.py
    â”œâ”€â”€ utils/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â””â”€â”€ permissions.py
    â”œâ”€â”€ main/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py
    â”‚   â””â”€â”€ templates/
    â”‚       â””â”€â”€ main/
    â”‚           â””â”€â”€ index.html
    â”œâ”€â”€ auth/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py
    â”‚   â””â”€â”€ templates/
    â”‚       â””â”€â”€ auth/
    â”‚           â””â”€â”€ login.html
    â”œâ”€â”€ admin/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py
    â”‚   â””â”€â”€ templates/
    â”‚       â””â”€â”€ admin/
    â”‚           â””â”€â”€ dashboard.html

1ï¸âƒ£ run.py
from app import create_app

app = create_app()

if __name__ == "__main__":
    app.run(debug=True)

2ï¸âƒ£ .env
FLASK_APP=run.py
FLASK_ENV=development
FLASK_DEBUG=1
SECRET_KEY=supersecretkey
DATABASE_URL=mysql+pymysql://user:password@localhost/flask_app?charset=utf8mb4
MAX_CONTENT_LENGTH=16MB
UPLOAD_FOLDER=instance/uploads

3ï¸âƒ£ app/config.py
import os
from dotenv import load_dotenv

load_dotenv()

class Config:
    SECRET_KEY = os.getenv("SECRET_KEY", "defaultsecret")
    SQLALCHEMY_DATABASE_URI = os.getenv("DATABASE_URL")
    SQLALCHEMY_TRACK_MODIFICATIONS = False
    CKEDITOR_PKG_TYPE = 'standard'
    UPLOAD_FOLDER = os.getenv("UPLOAD_FOLDER", "instance/uploads")
    MAX_CONTENT_LENGTH = 16 * 1024 * 1024  # 16MB

4ï¸âƒ£ app/extensions.py
from flask_sqlalchemy import SQLAlchemy
from flask_migrate import Migrate
from flask_login import LoginManager
from flask_ckeditor import CKEditor
from flask_wtf import CSRFProtect

db = SQLAlchemy()
migrate = Migrate()
login_manager = LoginManager()
ckeditor = CKEditor()
csrf = CSRFProtect()

5ï¸âƒ£ app/init.py
from flask import Flask
from .config import Config
from .extensions import db, migrate, login_manager, ckeditor, csrf

def create_app():
    app = Flask(__name__)
    app.config.from_object(Config)

    # Extensions
    db.init_app(app)
    migrate.init_app(app, db)
    login_manager.init_app(app)
    ckeditor.init_app(app)
    csrf.init_app(app)

    # Blueprints
    from .main import main_bp
    from .auth import auth_bp
    from .admin import admin_bp

    app.register_blueprint(main_bp)
    app.register_blueprint(auth_bp, url_prefix='/auth')
    app.register_blueprint(admin_bp, url_prefix='/admin')

    return app

6ï¸âƒ£ app/models/init.py
from .user import User
from .article import Article

app/models/user.py
from app.extensions import db
from flask_login import UserMixin

class User(UserMixin, db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
    password_hash = db.Column(db.String(120), nullable=False)
    role = db.Column(db.String(50), default='user')
    articles = db.relationship('Article', back_populates='author')

    def is_admin(self):
        return self.role == 'admin'

app/models/article.py
from datetime import datetime
from app.extensions import db
from sqlalchemy.orm import relationship

class Article(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    title = db.Column(db.String(150), nullable=False)
    article_body = db.Column(db.Text, nullable=False)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    author_id = db.Column(db.Integer, db.ForeignKey('user.id'))
    author = relationship('User', back_populates='articles')

7ï¸âƒ£ app/utils/permissions.py
from functools import wraps
from flask import abort
from flask_login import current_user

def admin_required(f):
    @wraps(f)
    def decorated(*args, **kwargs):
        if not (current_user.is_authenticated and current_user.is_admin()):
            abort(403)
        return f(*args, **kwargs)
    return decorated

8ï¸âƒ£ app/main/init.py
from flask import Blueprint

main_bp = Blueprint('main', __name__, template_folder='templates')

from . import routes

app/main/routes.py
from flask import render_template
from . import main_bp

@main_bp.route('/')
def index():
    return render_template('main/index.html')

app/main/templates/main/index.html
<h1>Welcome to Flask CKEditor App!</h1>

9ï¸âƒ£ app/auth/init.py
from flask import Blueprint

auth_bp = Blueprint('auth', __name__, template_folder='templates')

from . import routes

app/auth/routes.py
from flask import render_template
from . import auth_bp

@auth_bp.route('/login')
def login():
    return render_template('auth/login.html')

app/auth/templates/auth/login.html
<h1>Login Page</h1>

ğŸ”Ÿ app/admin/init.py
from flask import Blueprint

admin_bp = Blueprint('admin', __name__, template_folder='templates')

from . import routes

app/admin/routes.py
from flask import render_template
from . import admin_bp

@admin_bp.route('/')
def dashboard():
    return render_template('admin/dashboard.html')

app/admin/templates/admin/dashboard.html
<h1>Admin Dashboard</h1>

1ï¸âƒ£1ï¸âƒ£ requirements.txt
Flask==3.1.2
Flask-SQLAlchemy==3.1.1
Flask-Migrate==4.1.0
Flask-Login==0.6.3
Flask-WTF==1.2.2
Flask-CKEditor==1.0.0
PyMySQL==1.1.2
python-dotenv==1.2.1


âœ… Î‘Ï…Ï„Î® Î· Î´Î¿Î¼Î®:

Î›ÏÎ½ÎµÎ¹ TemplateNotFound (ÎºÎ¬Î¸Îµ Blueprint Î­Ï‡ÎµÎ¹ Ï„Î¿ Î´Î¹ÎºÏŒ Ï„Î¿Ï… template_folder).

Î›ÏÎ½ÎµÎ¹ ModuleNotFound / circular imports (ÏŒÎ»Î± Ï„Î± imports ÎµÎ¯Î½Î±Î¹ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ ÏƒÏ‰ÏƒÏ„Î¬).

Î ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î¬Î¶ÎµÎ¹ Î³Î¹Î± CKEditor uploads, login/permissions, MySQL + SQLAlchemy.

Î‘Î½ Î¸ÎµÏ‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ Î­Ï„Î¿Î¹Î¼Î¿ .env + migration scripts ÏÏƒÏ„Îµ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ Î±Î¼Î­ÏƒÏ‰Ï‚:

flask db init
flask db migrate -m "initial"
flask db upgrade


ÎºÎ±Î¹ Î½Î± Î­Ï‡ÎµÎ¹Ï‚ Ï„Î· Î²Î¬ÏƒÎ· Î­Ï„Î¿Î¹Î¼Î· Î³Î¹Î± articles & users.



ckeapp/
â”œâ”€â”€ run.py
â”œâ”€â”€ .env
â”œâ”€â”€ .flaskenv
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ instance/
â”‚   â””â”€â”€ uploads/
â””â”€â”€ app/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ config.py
    â”œâ”€â”€ extensions.py
    â”œâ”€â”€ models/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ user.py
    â”‚   â””â”€â”€ article.py
    â”œâ”€â”€ utils/
    â”‚   â””â”€â”€ permissions.py
    â”œâ”€â”€ templates/
    â”‚   â”œâ”€â”€ base.html          ğŸ‘ˆ ÎšÎŸÎ™ÎÎŸ
    â”‚   â”œâ”€â”€ auth/
    â”‚   â”‚   â””â”€â”€ login.html
    â”‚   â”œâ”€â”€ main/
    â”‚   â”‚   â””â”€â”€ index.html
    â”‚   â””â”€â”€ admin/
    â”‚       â””â”€â”€ dashboard.html
    â”œâ”€â”€ static/
    â”‚   â””â”€â”€ css/
    â”‚       â””â”€â”€ styles.css
    â”œâ”€â”€ main/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â””â”€â”€ routes.py
    â”œâ”€â”€ auth/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â””â”€â”€ routes.py
    â””â”€â”€ admin/
        â”œâ”€â”€ __init__.py
        â””â”€â”€ routes.py


app/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ config.py
â”œâ”€â”€ extensions.py
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ user.py
â”‚   â””â”€â”€ article.py
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ routes.py
â”‚   â””â”€â”€ forms.py
â”œâ”€â”€ admin/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ routes.py
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ routes.py
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ permissions.py
â””â”€â”€ templates/
    â”œâ”€â”€ base.html
    â”œâ”€â”€ _partials/
    â”‚   â””â”€â”€ navbar.html
    â”œâ”€â”€ auth/
    â”‚   â””â”€â”€ login.html
    â”œâ”€â”€ admin/
    â”‚   â””â”€â”€ dashboard.html
    â””â”€â”€ main/
        â””â”€â”€ index.html


6ï¸âƒ£ UI badges (Bootstrap)
<span class="badge bg-
{% if user.role == 'admin' %}danger
{% elif user.role == 'editor' %}warning
{% else %}secondary
{% endif %}
">
{{ user.role }}
</span>



8ï¸âƒ£ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€ÏÏÏ„Î¿Ï… Admin (once)

ğŸ“„ flask shell

from app import create_app
from app.extensions import db
from app.models.user import User

app = create_app()
app.app_context().push()

u = User(username="admin", email="admin@site.gr", role=User.ROLE_ADMIN)
u.set_password("admin123")
db.session.add(u)
db.session.commit()





Î ÏÏ‚ Î³ÏÎ¬Ï†ÎµÎ¹Ï‚ logs (Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±)
from app.models.activity_log import ActivityLog
from flask_login import current_user
from app.extensions import db
from flask import request

def log_action(action):
    log = ActivityLog(
        user_id=current_user.id if current_user.is_authenticated else None,
        action=action,
        ip_address=request.remote_addr
    )
    db.session.add(log)
    db.session.commit()


Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï‡ÏÎ®ÏƒÎ·Ï‚:
log_action("Deleted user ID 5")




ğŸ— Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® Î•Ï†Î±ÏÎ¼Î¿Î³Î®Ï‚ (Role-based)
ğŸ‘¤ Î¡ÏŒÎ»Î¿Î¹
Î¡ÏŒÎ»Î¿Ï‚	Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®
Visitor	Î§Ï‰ÏÎ¯Ï‚ login
User	Î‘Ï€Î»ÏŒÏ‚ ÎµÎ³Î³ÎµÎ³ÏÎ±Î¼Î¼Î­Î½Î¿Ï‚
Editor	Î£Ï…Î½Ï„Î¬ÎºÏ„Î·Ï‚
Admin	Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚
ğŸ” Î¤Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ¬Î½ÎµÎ¹ Î¿ ÎºÎ±Î¸Î­Î½Î±Ï‚
ğŸ‘€ Visitor (Ï‡Ï‰ÏÎ¯Ï‚ login)

âœ” Î ÏÎ¿Î²Î¿Î»Î® Î¬ÏÎ¸ÏÏ‰Î½
âœ” Î ÏÎ¿Î²Î¿Î»Î® ÏƒÏ‡Î¿Î»Î¯Ï‰Î½
âŒ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± / ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±
âŒ Admin Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚

ğŸ‘¤ User (ROLE_USER)

âœ” ÎŒ,Ï„Î¹ Î¿ Visitor
âœ” Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÏƒÏ‡Î¿Î»Î¯Ï‰Î½
âœ” Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± / Î´Î¹Î±Î³ÏÎ±Ï†Î® Î¼ÏŒÎ½Î¿ Ï„Ï‰Î½ Î´Î¹ÎºÏÎ½ Ï„Î¿Ï… ÏƒÏ‡Î¿Î»Î¯Ï‰Î½
âŒ Î†ÏÎ¸ÏÎ±
âŒ Admin

âœï¸ Editor (ROLE_EDITOR)

âœ” ÎŒ,Ï„Î¹ Î¿ User
âœ” Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î¬ÏÎ¸ÏÏ‰Î½
âœ” Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î´Î¹ÎºÏÎ½ Ï„Î¿Ï… Î¬ÏÎ¸ÏÏ‰Î½
âœ” Upload ÎµÎ¹ÎºÏŒÎ½Ï‰Î½ (CKEditor)
âŒ Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Ï‡ÏÎ·ÏƒÏ„ÏÎ½

ğŸ‘‘ Admin (ROLE_ADMIN)

âœ” Î Î»Î®ÏÎ·Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·
âœ” CRUD users
âœ” CRUD Î¬ÏÎ¸ÏÎ± / ÏƒÏ‡ÏŒÎ»Î¹Î±
âœ” Settings
âœ” Logs / Reports
âœ” Maintenance mode






ğŸ§­ Roadmap Î•Ï†Î±ÏÎ¼Î¿Î³Î®Ï‚ (Î±Ï€ÏŒ ÎµÎ´Ï ÎºÎ±Î¹ Ï€Î­ÏÎ±)
ğŸ§± Î¦Î‘Î£Î— 1 â€” Î£Ï„Î±Î¸ÎµÏÎ¿Ï€Î¿Î¯Î·ÏƒÎ· & ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ (Î Î¡Î©Î¤Î‘)
1ï¸âƒ£ Î•Î½Î¿Ï€Î¿Î¯Î·ÏƒÎ· Permissions (Î¥Î ÎŸÎ§Î¡Î•Î©Î¤Î™ÎšÎŸ)

âœ” ÎˆÎ½Î± ÏƒÏÏƒÏ„Î·Î¼Î± roles
âœ” Blueprint-level protection
âœ” ÎšÎ±Î¼Î¯Î± Î´Î¹Ï€Î»Î® Î»Î¿Î³Î¹ÎºÎ®

ÎšÎ¬Î½ÎµÎ¹Ï‚:

admin_bp.before_request â†’ admin-only

editor_bp.before_request â†’ editor + admin

auth, main Ï‡Ï‰ÏÎ¯Ï‚ Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯Î±

ğŸ“ Î‘ÏÏ‡ÎµÎ¯Î±:

app/utils/permissions.py

app/admin/__init__.py

app/editor/__init__.py

2ï¸âƒ£ Î¤ÎµÎ»Î¹ÎºÏŒ Î¼Î¿Î½Ï„Î­Î»Î¿ ÏÏŒÎ»Ï‰Î½
ADMIN   â†’ Ï€Î»Î®ÏÎ·Ï‚ Î­Î»ÎµÎ³Ï‡Î¿Ï‚
EDITOR  â†’ Î¬ÏÎ¸ÏÎ±
USER    â†’ ÏƒÏ‡ÏŒÎ»Î¹Î±
VISITOR â†’ read-only


âœ” Helper methods ÏƒÏ„Î¿ User
âœ” Î£Ï„Î±Î¸ÎµÏÎ­Ï‚ roles

ğŸ“ models/user.py

3ï¸âƒ£ Activity Logs (Î¸ÎµÎ¼Î­Î»Î¹Î¿)

âœ” Log ÎºÎ¬Î¸Îµ admin / editor ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±Ï‚
âœ” Audit trail

Events Ï€Î¿Ï… Î¸Î± Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Î¹:

login / logout

register

create / edit / delete article

delete user

settings change

ğŸ“

models/activity_log.py

utils/logs.py

âœï¸ Î¦Î‘Î£Î— 2 â€” Editor / Articles (ÎšÎ¥Î¡Î™ÎŸ FEATURE)
4ï¸âƒ£ Article CRUD (Editor)

Routes:

/editor/articles
/editor/articles/create
/editor/articles/<id>/edit
/editor/articles/<id>/delete


âœ” Admin Î²Î»Î­Ï€ÎµÎ¹ ÏŒÎ»Î±
âœ” Editor Î¼ÏŒÎ½Î¿ Ï„Î± Î´Î¹ÎºÎ¬ Ï„Î¿Ï…

ğŸ“

editor/routes.py

editor/forms.py

editor/templates/articles/*

5ï¸âƒ£ CKEditor integration

âœ” Rich text
âœ” Safe HTML
âœ” Upload images

ğŸ“

editor/forms.py

editor/routes.py

config.py

6ï¸âƒ£ Secure Image Upload

âœ” Whitelist extensions
âœ” Random filenames
âœ” Folder per model
âœ” No overwrite

ğŸ“

utils/uploads.py

static/uploads/articles/

ğŸ’¬ Î¦Î‘Î£Î— 3 â€” Comments System
7ï¸âƒ£ Comment Model
Comment:
- id
- body
- user_id
- article_id
- created_at


âœ” FK constraints
âœ” Cascade delete

ğŸ“

models/comment.py

8ï¸âƒ£ Permissions ÏƒÏ„Î± ÏƒÏ‡ÏŒÎ»Î¹Î±
Î¡ÏŒÎ»Î¿Ï‚	Î”ÏÎ¬ÏƒÎ·
Visitor	Read
User	Create / Edit own
Admin	Delete

ğŸ“

main/routes.py

utils/permissions.py

ğŸŒ Î¦Î‘Î£Î— 4 â€” Public Website
9ï¸âƒ£ Public Î¬ÏÎ¸ÏÎ±

Routes:

/
/articles
/articles/<slug>


âœ” Pagination
âœ” SEO-friendly URLs

ğŸ“

main/routes.py

templates/main/articles/*

ğŸ”Ÿ Search & Filters

âœ” title search
âœ” author filter
âœ” date filter

ğŸ›  Î¦Î‘Î£Î— 5 â€” Admin Panel (Advanced)
1ï¸âƒ£1ï¸âƒ£ Admin Users CRUD

âœ” Create user
âœ” Edit role
âœ” Deactivate
âœ” Delete

ğŸ“

admin/routes.py

admin/forms.py

admin/templates/users/*

1ï¸âƒ£2ï¸âƒ£ Admin Settings

âœ” Maintenance mode
âœ” Site title
âœ” Upload limits

ğŸ“

models/settings.py

admin/settings.py

middleware.py

1ï¸âƒ£3ï¸âƒ£ Logs Viewer

âœ” Filters
âœ” Pagination
âœ” Admin-only

ğŸ“

admin/routes.py

admin/templates/logs.html

ğŸ”’ Î¦Î‘Î£Î— 6 â€” Security & UX polish
1ï¸âƒ£4ï¸âƒ£ Security

âœ” CSRF everywhere
âœ” Rate limit login
âœ” Strong passwords
âœ” Disable HTML injection

1ï¸âƒ£5ï¸âƒ£ UX

âœ” Flash messages by category
âœ” Confirm dialogs
âœ” Disabled buttons
âœ” Empty states

ğŸš€ Î¦Î‘Î£Î— 7 â€” Production readiness
1ï¸âƒ£6ï¸âƒ£ Config per environment
config/
 â”œâ”€ dev.py
 â”œâ”€ prod.py

1ï¸âƒ£7ï¸âƒ£ Deployment prep

âœ” gunicorn
âœ” nginx
âœ” mysql tuning
âœ” logging to file

ğŸ§  Î£ÎµÎ¹ÏÎ¬ Î¥Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ (ÏƒÏ…Î½Î¿Ï€Ï„Î¹ÎºÎ¬)

1ï¸âƒ£ Permissions + roles
2ï¸âƒ£ Logs
3ï¸âƒ£ Editor CRUD
4ï¸âƒ£ CKEditor + uploads
5ï¸âƒ£ Comments
6ï¸âƒ£ Public articles
7ï¸âƒ£ Admin panel
8ï¸âƒ£ Security
9ï¸âƒ£ Deployment

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚:
â¡ ÎÎµÎºÎ¹Î½Î¬Î¼Îµ Î±Î¼Î­ÏƒÏ‰Ï‚ Î±Ï€ÏŒ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î²Î®Î¼Î± (1ï¸âƒ£ Permissions cleanup)
â¡ Î® Î±Ï€ÏŒ 4ï¸âƒ£ Article editor Î¼Îµ CKEditor (Ï€Î¹Î¿ â€œÎ¿ÏÎ±Ï„ÏŒâ€ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±)


